(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{9986:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/board",function(){return r(5325)}])},5325:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(4051),o=r.n(n),c=r(5893),s=r(7294),u=r(1163),a=r(7676),i=function(e){var t=e.owner,r=e.value,n=e.position,o=e.onClick,s=e.selected;return(0,c.jsx)("div",{style:{minWidth:"4rem",textAlign:"center",height:"4rem",backgroundColor:null===t||void 0===t?void 0:t.color,borderRadius:"1rem",borderStyle:"solid",borderColor:s?"gold":"white",borderWidth:"2px",color:"white",fontSize:"25px",lineHeight:"3.4rem"},onClick:o(n,t),children:r})},l=r(520),f=r(214),d=r.n(f);function p(e,t,r,n,o,c,s){try{var u=e[c](s),a=u.value}catch(i){return void r(i)}u.done?t(a):Promise.resolve(a).then(n,o)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function s(e){p(c,n,o,s,u,"next",e)}function u(e){p(c,n,o,s,u,"throw",e)}s(void 0)}))}}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){S(e,t,r[t])}))}return e}var b=function(){var e=(0,s.useState)(8),t=e[0],r=e[1],n=(0,s.useState)(8),f=n[0],p=n[1],S=(0,s.useState)(Array.from(Array(f).keys()).map((function(e){return Array.from(Array(t).keys()).map((function(e){return{val:0,owner:void 0}}))}))),b=S[0],y=S[1],_=(0,s.useState)(null),E=_[0],O=_[1],w=(0,s.useState)(null),m=w[0],N=w[1],T=(0,s.useState)(!1),k=T[0],g=T[1],R=(0,a.ZP)(l.s).lastMessage,C=function(e,t){y((function(r){var n=r;return n[e.y][e.x]=t,n}))},x=function(){var e=v(o().mark((function e(){var t,n,c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(l.T,"/board/config"));case 2:return e.next=4,e.sent.json();case 4:return t=e.sent,e.next=7,fetch("".concat(l.T,"/board/users"));case 7:return e.next=9,e.sent.json();case 9:return n=e.sent,e.next=12,fetch("".concat(l.T,"/board"));case 12:return e.next=14,e.sent.json();case 14:return c=e.sent,e.next=17,fetch("".concat(l.T,"/board/hashed_user?id=").concat(localStorage.getItem("login")));case 17:return e.next=19,e.sent.json();case 19:(s=e.sent)in n||u.default.push("/"),y(c.map((function(e){return e.map((function(e){return h({},e,{owner:e.owner?{id:e.owner,color:n[e.owner]}:null})}))}))),r(t.width),p(t.height),N({id:s,color:n[s]}),g(!0);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){if(null===R||void 0===R?void 0:R.data){var e=JSON.parse(R.data);y(e.board.map((function(t){return t.map((function(t){return h({},t,{owner:t.owner?{id:t.owner,color:e.users[t.owner]}:null})}))})))}}),[R]),(0,s.useEffect)((function(){v(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:case"end":return e.stop()}}),e)})))()}),[]);var I=function(){var e=v(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(l.T,"/board/move?start=").concat(E.pos.y,",").concat(E.pos.x,"&end=").concat(t.y,",").concat(t.x,"&id=").concat(localStorage.getItem("login")),{method:"POST"});case 2:return e.next=4,x();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e,t){return v(o().mark((function r(){var n,c,s,u;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(E){r.next=4;break}O({pos:e,owner:t}),r.next=37;break;case 4:if((e.x!=E.pos.x+1&&e.x!=E.pos.x-1||e.y!=E.pos.y)&&(e.y!=E.pos.y+1&&e.y!=E.pos.y-1||e.x!=E.pos.x)){r.next=36;break}if(s=b[E.pos.y][E.pos.x].val,u=b[e.y][e.x].val,!(m.id==(null===(n=E.owner)||void 0===n?void 0:n.id)&&s>1)){r.next=25;break}if(t&&m.id!=(null===t||void 0===t?void 0:t.id)){r.next=17;break}return C(e,{val:Math.floor(s/2)+u,owner:m}),C(E.pos,{val:Math.ceil(s/2),owner:m}),O(null),r.next=15,I(e);case 15:r.next=23;break;case 17:if(!(s>u)){r.next=23;break}return C(e,{val:0,owner:null}),C(E.pos,{val:s-u,owner:m}),O(null),r.next=23,I(e);case 23:r.next=34;break;case 25:if(m.id!=(null===(c=E.owner)||void 0===c?void 0:c.id)||m.id!=(null===t||void 0===t?void 0:t.id)||1!=s){r.next=33;break}return C(e,{val:1+u,owner:m}),C(E.pos,{val:0,owner:null}),O(null),r.next=31,I(e);case 31:r.next=34;break;case 33:O({pos:e,owner:t});case 34:r.next=37;break;case 36:e.x==E.pos.x&&e.y==E.pos.y?O(null):O({pos:e,owner:t});case 37:case"end":return r.stop()}}),r)})))};return k?(0,c.jsxs)("div",{style:{width:"100%"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,c.jsx)("h1",{style:{color:null===m||void 0===m?void 0:m.color},children:"Your Color: "}),(0,c.jsx)("div",{style:{width:"4rem",textAlign:"center",height:"4rem",backgroundColor:null===m||void 0===m?void 0:m.color,borderRadius:"1rem",borderStyle:"solid",borderColor:"white",borderWidth:"2px",color:"white",fontSize:"25px",lineHeight:"3.4rem",marginLeft:"1.5%"}})]}),(0,c.jsx)("div",{style:{width:"100%"},children:Array.from(Array(f).keys()).map((function(e){return(0,c.jsx)("div",{style:{display:"flex",flexDirection:"row",minWidth:"100%"},children:Array.from(Array(t).keys()).map((function(t){return(0,c.jsx)(i,{value:b[e][t].val,position:{x:t,y:e},onClick:P,selected:E&&t==E.pos.x&&e==E.pos.y,owner:b[e][t].owner})}))})}))})]}):(0,c.jsx)("div",{className:d().container,children:(0,c.jsx)("main",{className:d().main,children:(0,c.jsx)("h1",{className:d().title,children:"Loading the board..."})})})}},520:function(e,t,r){"use strict";r.d(t,{T:function(){return n},s:function(){return o}});var n="https://EmpireBackend.asra.repl.co",o="wss://EmpireBackend.asra.repl.co/websocket"},214:function(e){e.exports={container:"Home_container__bCOhY",main:"Home_main__nLjiQ",footer:"Home_footer____T7K",title:"Home_title__T09hD",description:"Home_description__41Owk",code:"Home_code__suPER",grid:"Home_grid__GxQ85",card:"Home_card___LpL1",logo:"Home_logo__27_tb"}},1163:function(e,t,r){e.exports=r(387)},7676:function(e,t,r){"use strict";var n=r(1835);Object.defineProperty(t,"ZP",{enumerable:!0,get:function(){return n.useWebSocket}});var o=r(6548);var c=r(1581);var s=r(9448);var u=r(9885)},3682:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.attachListeners=void 0;var o=r(1787),c=r(1581),s=r(9885);t.attachListeners=function(e,t,r,u,a,i){var l,f,d,p=t.setLastMessage,v=t.setReadyState;return r.current.fromSocketIO&&(l=o.setUpSocketIOPing(i)),function(e,t,r){e.onmessage=function(e){t.current.onMessage&&t.current.onMessage(e),"function"===typeof t.current.filter&&!0!==t.current.filter(e)||r(e)}}(e,r,p),function(e,t,r,n){e.onopen=function(e){t.current.onOpen&&t.current.onOpen(e),n.current=0,r(c.ReadyState.OPEN)}}(e,r,v,a),f=function(e,t,r,n,o){return c.isEventSourceSupported&&e instanceof EventSource?function(){}:(s.assertIsWebSocket(e),e.onclose=function(e){var s,a;if(t.current.onClose&&t.current.onClose(e),r(c.ReadyState.CLOSED),t.current.shouldReconnect&&t.current.shouldReconnect(e)){var i=null!==(s=t.current.reconnectAttempts)&&void 0!==s?s:c.DEFAULT_RECONNECT_LIMIT;o.current<i?u=window.setTimeout((function(){o.current++,n()}),null!==(a=t.current.reconnectInterval)&&void 0!==a?a:c.DEFAULT_RECONNECT_INTERVAL_MS):(t.current.onReconnectStop&&t.current.onReconnectStop(i),console.warn("Max reconnect attempts of "+i+" exceeded"))}},function(){return u&&window.clearTimeout(u)});var u}(e,r,v,u,a),d=function(e,t,r,o,s){var u;return e.onerror=function(a){var i,l;t.current.onError&&t.current.onError(a),c.isEventSourceSupported&&e instanceof EventSource&&(t.current.onClose&&t.current.onClose(n(n({},a),{code:1006,reason:"An error occurred with the EventSource: "+a,wasClean:!1})),r(c.ReadyState.CLOSED),e.close()),t.current.retryOnError&&(s.current<(null!==(i=t.current.reconnectAttempts)&&void 0!==i?i:c.DEFAULT_RECONNECT_LIMIT)?u=window.setTimeout((function(){s.current++,o()}),null!==(l=t.current.reconnectInterval)&&void 0!==l?l:c.DEFAULT_RECONNECT_INTERVAL_MS):(t.current.onReconnectStop&&t.current.onReconnectStop(t.current.reconnectAttempts),console.warn("Max reconnect attempts of "+t.current.reconnectAttempts+" exceeded")))},function(){return u&&window.clearTimeout(u)}}(e,r,v,u,a),function(){v(c.ReadyState.CLOSING),f(),d(),e.close(),l&&clearInterval(l)}}},7678:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.attachSharedListeners=void 0;var o=r(4401),c=r(1581),s=r(4480),u=r(1787);t.attachSharedListeners=function(e,t,r,a){var i;return r.current.fromSocketIO&&(i=u.setUpSocketIOPing(a)),function(e,t){e.onmessage=function(e){s.getSubscribers(t).forEach((function(t){t.optionsRef.current.onMessage&&t.optionsRef.current.onMessage(e),"function"===typeof t.optionsRef.current.filter&&!0!==t.optionsRef.current.filter(e)||t.setLastMessage(e)}))}}(e,t),function(e,t){e instanceof WebSocket&&(e.onclose=function(e){s.getSubscribers(t).forEach((function(t){t.optionsRef.current.onClose&&t.optionsRef.current.onClose(e),t.setReadyState(c.ReadyState.CLOSED)})),delete o.sharedWebSockets[t],s.getSubscribers(t).forEach((function(t){var r,n;if(t.optionsRef.current.shouldReconnect&&t.optionsRef.current.shouldReconnect(e)){var o=null!==(r=t.optionsRef.current.reconnectAttempts)&&void 0!==r?r:c.DEFAULT_RECONNECT_LIMIT;t.reconnectCount.current<o?setTimeout((function(){t.reconnectCount.current++,t.reconnect.current()}),null!==(n=t.optionsRef.current.reconnectInterval)&&void 0!==n?n:c.DEFAULT_RECONNECT_INTERVAL_MS):(t.optionsRef.current.onReconnectStop&&t.optionsRef.current.onReconnectStop(t.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of "+o+" exceeded"))}}))})}(e,t),function(e,t){e.onopen=function(e){s.getSubscribers(t).forEach((function(t){t.reconnectCount.current=0,t.optionsRef.current.onOpen&&t.optionsRef.current.onOpen(e),t.setReadyState(c.ReadyState.OPEN)}))}}(e,t),function(e,t){e.onerror=function(r){s.getSubscribers(t).forEach((function(t){t.optionsRef.current.onError&&t.optionsRef.current.onError(r),c.isEventSourceSupported&&e instanceof EventSource&&(t.optionsRef.current.onClose&&t.optionsRef.current.onClose(n(n({},r),{code:1006,reason:"An error occurred with the EventSource: "+r,wasClean:!1})),t.setReadyState(c.ReadyState.CLOSED))})),c.isEventSourceSupported&&e instanceof EventSource&&e.close()}}(e,t),function(){i&&clearInterval(i)}}},1581:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEventSourceSupported=t.isReactNative=t.ReadyState=t.UNPARSABLE_JSON_OBJECT=t.DEFAULT_RECONNECT_INTERVAL_MS=t.DEFAULT_RECONNECT_LIMIT=t.SOCKET_IO_PING_CODE=t.SOCKET_IO_PATH=t.SOCKET_IO_PING_INTERVAL=t.DEFAULT_EVENT_SOURCE_OPTIONS=t.EMPTY_EVENT_HANDLERS=t.DEFAULT_OPTIONS=void 0;t.DEFAULT_OPTIONS={},t.EMPTY_EVENT_HANDLERS={},t.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:t.EMPTY_EVENT_HANDLERS},t.SOCKET_IO_PING_INTERVAL=25e3,t.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",t.SOCKET_IO_PING_CODE="2",t.DEFAULT_RECONNECT_LIMIT=20,t.DEFAULT_RECONNECT_INTERVAL_MS=5e3,t.UNPARSABLE_JSON_OBJECT={},function(e){e[e.UNINSTANTIATED=-1]="UNINSTANTIATED",e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(t.ReadyState||(t.ReadyState={}));t.isReactNative="undefined"!==typeof navigator&&"ReactNative"===navigator.product,t.isEventSourceSupported=!t.isReactNative&&function(){try{return"EventSource"in globalThis}catch(e){return!1}}()},3758:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOrJoinSocket=void 0;var n=r(4401),o=r(1581),c=r(3682),s=r(7678),u=r(4480);t.createOrJoinSocket=function(e,t,r,a,i,l,f,d){if(!o.isEventSourceSupported&&a.current.eventSourceOptions)throw o.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(a.current.share){var p=null;void 0===n.sharedWebSockets[t]?(n.sharedWebSockets[t]=a.current.eventSourceOptions?new EventSource(t,a.current.eventSourceOptions):new WebSocket(t,a.current.protocols),e.current=n.sharedWebSockets[t],r(o.ReadyState.CONNECTING),p=s.attachSharedListeners(n.sharedWebSockets[t],t,a,d)):(e.current=n.sharedWebSockets[t],r(n.sharedWebSockets[t].readyState));var v={setLastMessage:i,setReadyState:r,optionsRef:a,reconnectCount:f,reconnect:l};return u.addSubscriber(t,v),function(e,t,r,c,s){return function(){if(u.removeSubscriber(e,t),!u.hasSubscribers(e)){try{var a=n.sharedWebSockets[e];a instanceof WebSocket&&(a.onclose=function(e){r.current.onClose&&r.current.onClose(e),c(o.ReadyState.CLOSED)}),a.close()}catch(i){}s&&s(),delete n.sharedWebSockets[e]}}}(t,v,a,r,p)}if(e.current=a.current.eventSourceOptions?new EventSource(t,a.current.eventSourceOptions):new WebSocket(t,a.current.protocols),r(o.ReadyState.CONNECTING),!e.current)throw new Error("WebSocket failed to be created");return c.attachListeners(e.current,{setLastMessage:i,setReadyState:r},a,l.current,f,d)}},6974:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function s(e){try{a(n.next(e))}catch(t){c(t)}}function u(e){try{a(n.throw(e))}catch(t){c(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,c,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function u(c){return function(u){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(u){c=[6,u],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUrl=void 0;var c=r(1787);t.getUrl=function(e,t){return n(void 0,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return"function"!==typeof e?[3,2]:[4,e()];case 1:return r=o.sent(),[3,3];case 2:r=e,o.label=3;case 3:return n=t.current.fromSocketIO?c.parseSocketIOUrl(r):r,[2,t.current.queryParams?c.appendQueryParams(n,t.current.queryParams):n]}}))}))}},4401:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetWebSockets=t.sharedWebSockets=void 0,t.sharedWebSockets={},t.resetWebSockets=function(e){if(e&&t.sharedWebSockets.hasOwnProperty(e))delete t.sharedWebSockets[e];else for(var r in t.sharedWebSockets)t.sharedWebSockets.hasOwnProperty(r)&&delete t.sharedWebSockets[r]}},4480:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetSubscribers=t.removeSubscriber=t.addSubscriber=t.hasSubscribers=t.getSubscribers=void 0;var r={},n=[];t.getSubscribers=function(e){return t.hasSubscribers(e)?Array.from(r[e]):n},t.hasSubscribers=function(e){var t;return(null===(t=r[e])||void 0===t?void 0:t.size)>0},t.addSubscriber=function(e,t){r[e]=r[e]||new Set,r[e].add(t)},t.removeSubscriber=function(e,t){r[e].delete(t)},t.resetSubscribers=function(e){if(e&&r.hasOwnProperty(e))delete r[e];else for(var t in r)r.hasOwnProperty(t)&&delete r[t]}},4387:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.websocketWrapper=void 0,t.websocketWrapper=function(e,t){return new Proxy(e,{get:function(e,r){var n=e[r];return"reconnect"===r?t:"function"===typeof n?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):n},set:function(e,t,r){return/^on/.test(t)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(e[t]=r,!0)}})},t.default=t.websocketWrapper},1787:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpSocketIOPing=t.appendQueryParams=t.parseSocketIOUrl=void 0;var n=r(1581);t.parseSocketIOUrl=function(e){if(e)return(t=/^https|wss/.test(e)?"wss":"ws")+"://"+e.replace(/^(https?|wss?)(:\/\/)?/,"").replace(/\/$/,"")+n.SOCKET_IO_PATH;if(""===e){var t=/^https/.test(window.location.protocol)?"wss":"ws",r=window.location.port?":"+window.location.port:"";return t+"://"+window.location.hostname+r+n.SOCKET_IO_PATH}return e},t.appendQueryParams=function(e,t){void 0===t&&(t={});return e+(/\?([\w]+=[\w]+)/.test(e)?"&":"?")+(""+Object.entries(t).reduce((function(e,t){return e+(t[0]+"=")+t[1]+"&"}),"").slice(0,-1))},t.setUpSocketIOPing=function(e,t){void 0===t&&(t=n.SOCKET_IO_PING_INTERVAL);return setInterval((function(){return e(n.SOCKET_IO_PING_CODE)}),t)}},9448:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.useEventSource=void 0;var c=r(7294),s=r(1835),u=r(1581);t.useEventSource=function(e,t,r){void 0===t&&(t=u.DEFAULT_EVENT_SOURCE_OPTIONS),void 0===r&&(r=!0);var a=t.withCredentials,i=t.events,l=o(t,["withCredentials","events"]),f=n(n({},l),{eventSourceOptions:{withCredentials:a}}),d=c.useRef(u.EMPTY_EVENT_HANDLERS);i&&(d.current=i);var p=s.useWebSocket(e,f,r),v=p.lastMessage,S=p.readyState,h=p.getWebSocket;return c.useEffect((function(){(null===v||void 0===v?void 0:v.type)&&Object.entries(d.current).forEach((function(e){var t=e[0],r=e[1];t===v.type&&r(v)}))}),[v]),{lastEvent:v,readyState:S,getEventSource:h}}},6548:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.useSocketIO=void 0;var o=r(7294),c=r(1835),s=r(1581),u={type:"empty",payload:null};t.useSocketIO=function(e,t,r){void 0===t&&(t=s.DEFAULT_OPTIONS),void 0===r&&(r=!0);var a=o.useMemo((function(){return n(n({},t),{fromSocketIO:!0})}),[]),i=c.useWebSocket(e,a,r),l=i.sendMessage,f=i.sendJsonMessage,d=i.lastMessage,p=i.readyState,v=i.getWebSocket,S=o.useMemo((function(){return function(e){if(!e||!e.data)return u;var t=e.data.match(/\[.*]/);if(!t)return u;var r=JSON.parse(t);return Array.isArray(r)&&r[1]?{type:r[0],payload:r[1]}:u}(d)}),[d]);return{sendMessage:l,sendJsonMessage:f,lastMessage:S,lastJsonMessage:S,readyState:p,getWebSocket:v}}},1835:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function s(e){try{a(n.next(e))}catch(t){c(t)}}function u(e){try{a(n.throw(e))}catch(t){c(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var r,n,o,c,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function u(c){return function(u){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(u){c=[6,u],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useWebSocket=void 0;var u=r(7294),a=r(1581),i=r(3758),l=r(6974),f=s(r(4387)),d=r(9885);t.useWebSocket=function(e,t,r){void 0===t&&(t=a.DEFAULT_OPTIONS),void 0===r&&(r=!0);var s=u.useState(null),p=s[0],v=s[1],S=u.useState({}),h=S[0],b=S[1],y=u.useMemo((function(){if(p)try{return JSON.parse(p.data)}catch(e){return a.UNPARSABLE_JSON_OBJECT}return null}),[p]),_=u.useRef(null),E=u.useRef(null),O=u.useRef((function(){})),w=u.useRef(0),m=u.useRef([]),N=u.useRef(null),T=u.useRef(t);T.current=t;var k=_.current&&void 0!==h[_.current]?h[_.current]:null!==e&&!0===r?a.ReadyState.CONNECTING:a.ReadyState.UNINSTANTIATED,g=t.queryParams?JSON.stringify(t.queryParams):null,R=u.useCallback((function(e,t){var r;void 0===t&&(t=!0),a.isEventSourceSupported&&E.current instanceof EventSource?console.warn("Unable to send a message from an eventSource"):(null===(r=E.current)||void 0===r?void 0:r.readyState)===a.ReadyState.OPEN?(d.assertIsWebSocket(E.current),E.current.send(e)):t&&m.current.push(e)}),[]),C=u.useCallback((function(e,t){void 0===t&&(t=!0),R(JSON.stringify(e),t)}),[R]),x=u.useCallback((function(){return!0!==T.current.share||a.isEventSourceSupported&&E.current instanceof EventSource?E.current:(null===N.current&&E.current&&(d.assertIsWebSocket(E.current),N.current=f.default(E.current,O)),N.current)}),[]);return u.useEffect((function(){if(null!==e&&!0===r){var t,s=!1,u=function(){return o(void 0,void 0,void 0,(function(){var r,o,u;return c(this,(function(c){switch(c.label){case 0:return r=_,[4,l.getUrl(e,T)];case 1:return r.current=c.sent(),o=function(e){s||v(e)},u=function(e){s||b((function(t){var r;return n(n({},t),_.current&&((r={})[_.current]=e,r))}))},t=i.createOrJoinSocket(E,_.current,u,T,o,O,w,R),[2]}}))}))};return O.current=function(){s||(N.current&&(N.current=null),null===t||void 0===t||t(),u())},u(),function(){s=!0,N.current&&(N.current=null),null===t||void 0===t||t(),v(null)}}null!==e&&!1!==r||(w.current=0,b((function(e){var t;return n(n({},e),_.current&&((t={})[_.current]=a.ReadyState.CLOSED,t))})))}),[e,r,g,R]),u.useEffect((function(){k===a.ReadyState.OPEN&&m.current.splice(0).forEach((function(e){R(e)}))}),[k]),{sendMessage:R,sendJsonMessage:C,lastMessage:p,lastJsonMessage:y,readyState:k,getWebSocket:x}}},9885:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetGlobalState=t.assertIsWebSocket=void 0;var n=r(4401),o=r(4480);t.assertIsWebSocket=function(e){if(e instanceof WebSocket===!1)throw new Error("")},t.resetGlobalState=function(e){o.resetSubscribers(e),n.resetWebSockets(e)}}},function(e){e.O(0,[774,888,179],(function(){return t=9986,e(e.s=t);var t}));var t=e.O();_N_E=t}]);